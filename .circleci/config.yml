version: 2
jobs:
  build:
    docker:
      - image: cirrusci/flutter
    steps:
      - checkout
      - run: flutter doctor
      - run:
          name: Install dependencies
          command: sudo apt-get install build-essential patch ruby-dev zlib1g-dev liblzma-dev
      - run:
          name: Install Nokogiri
          command: sudo gem install nokogiri -v '1.6.7.1'
      - run:
          name: Install missing gems
          command: cd ./android && bundle install
      - run:
          name: Run fastlane test
          command: cd ./android/fastlane && bundle exec fastlane test
      

workflows:
  version: 2
  build-deploy:
    jobs:
      - build:
          filters:
            branches:
              only: feat/setup-landing-page